<dataConfig>
    <dataSource type="JdbcDataSource" driver="com.mysql.jdbc.Driver" url="jdbc:mysql://db1.spistresci.pl/st_414" user="root" password="NGUcIpHoz1UI" batchSize="-1" />
    <document>
        <entity name="MasterBook" query="select 'spistresci.MasterBookSolrWrapper' as django_ct, id, title, format_mobi, format_epub, format_pdf, format_cd, format_mp3, price from MasterBook where active = 1;">

            <field column="django_ct" name="django_ct" />
            <field column="id" name="id" />
            <field column="title" name="title" />
            <field column="format_mobi" name="format_mobi" />
            <field column="format_epub" name="format_epub" />
            <field column="format_pdf" name="format_pdf" />
            <field column="format_cd" name="format_cd" />
            <field column="format_mp3" name="format_mp3" />
            <field column="price" name="price_lowest" />

            <entity name="master_books_master_authors" query="select author_id from master_books_master_authors where book_id='${MasterBook.id}'">
                <entity name="MasterAuthor" query="select name, firstName, middleName, lastName from MasterAuthor where id = '${master_books_master_authors.author_id}'" >
                    <field column="name" name="name" />
                    <field column="firstName" name="firstName" />
                    <field column="middleName" name="middleName" />
                    <field column="lastName" name="lastName" />
                </entity>
            </entity>

            <entity name="MiniBook" query="select bookstore, price, url, cover, format_mobi, format_epub, format_pdf, format_cd, format_mp3 from MiniBook where master_id='${MasterBook.id}'">
                <field name="bookstore" column="bookstore" />
                <field name="price" column="price" />
                <field name="url" column="url" />
                <field name="cover" column="cover" />
                <field name="mini_format_mobi" column="format_mobi" />
                <field name="mini_format_epub" column="format_epub" />
                <field name="mini_format_pdf" column="format_pdf" />
                <field name="mini_format_cd" column="format_cd" />
                <field name="mini_format_mp3" column="format_mp3" />
            </entity>

        </entity>
    </document>
</dataConfig>

